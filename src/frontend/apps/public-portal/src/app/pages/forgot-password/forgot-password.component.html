<div class="forgot-password-container">
  <div class="forgot-password-card">
    <!-- Header -->
    <div class="header">
      @if (!emailSent()) {
        <div class="icon-wrapper">
          <svg class="lock-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
          </svg>
        </div>
        <h1 class="title">Passwort vergessen?</h1>
        <p class="subtitle">Kein Problem! Geben Sie Ihre E-Mail-Adresse ein und wir senden Ihnen einen Link zum Zurücksetzen.</p>
      } @else {
        <div class="icon-wrapper success">
          <svg class="check-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 19v-8.93a2 2 0 01.89-1.664l7-4.666a2 2 0 012.22 0l7 4.666A2 2 0 0121 10.07V19M3 19a2 2 0 002 2h14a2 2 0 002-2M3 19l6.75-4.5M21 19l-6.75-4.5M3 10l6.75 4.5M21 10l-6.75 4.5m0 0l-1.14.76a2 2 0 01-2.22 0l-1.14-.76"></path>
          </svg>
        </div>
        <h1 class="title">E-Mail gesendet!</h1>
        <p class="subtitle">Überprüfen Sie Ihren Posteingang</p>
      }
    </div>

    <!-- Success Message -->
    @if (successMessage()) {
      <ui-success-alert [message]="successMessage()!"></ui-success-alert>
    }

    <!-- Error Message -->
    @if (errorMessage()) {
      <ui-error-alert [message]="errorMessage()!"></ui-error-alert>
    }

    <!-- Form -->
    @if (!emailSent()) {
      <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()" class="form">
        <ui-form-field 
          label="E-Mail-Adresse" 
          inputId="email" 
          [required]="true"
          [hasError]="!!emailError"
          [errorMessage]="emailError"
        >
          <input
            id="email"
            type="email"
            formControlName="email"
            placeholder="ihre-email@beispiel.de"
            autocomplete="email"
          />
        </ui-form-field>

        <button
          type="submit"
          class="submit-button"
          [disabled]="isLoading()"
        >
          @if (isLoading()) {
            <svg class="spinner" viewBox="0 0 24 24">
              <circle class="spinner-circle" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle>
            </svg>
            <span>Wird gesendet...</span>
          } @else {
            <span>Link zum Zurücksetzen senden</span>
          }
        </button>
      </form>
    }

    <!-- Additional Info -->
    @if (emailSent()) {
      <div class="info-box">
        <p class="info-title">Was kommt als Nächstes?</p>
        <ol class="info-list">
          <li>Überprüfen Sie Ihren Posteingang (und Spam-Ordner)</li>
          <li>Klicken Sie auf den Link in der E-Mail</li>
          <li>Erstellen Sie ein neues Passwort</li>
          <li>Melden Sie sich mit Ihrem neuen Passwort an</li>
        </ol>
        <p class="info-note">Der Link ist 24 Stunden lang gültig.</p>
      </div>

      <button
        type="button"
        class="resend-button"
        [disabled]="isLoading()"
        (click)="emailSent.set(false)"
      >
        Eine weitere E-Mail senden
      </button>
    }

    <!-- Back to Login -->
    <div class="back-to-login">
      <a routerLink="/login" class="back-link">
        <svg class="arrow-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
        </svg>
        <span>Zurück zur Anmeldung</span>
      </a>
    </div>
  </div>
</div>
