<div class="forgot-password-container">
  <div class="forgot-password-card">
    <!-- Header -->
    <div class="header">
      @if (!emailSent()) {
        <div class="icon-wrapper">
          <lib-icon name="lock" variant="outline" size="lg" class="lock-icon" />
        </div>
        <h1 class="title">{{ 'auth.forgotPassword.title' | translate }}</h1>
        <p class="subtitle">{{ 'auth.forgotPassword.subtitle' | translate }}</p>
      } @else {
        <div class="icon-wrapper success">
          <lib-icon name="mail-open" variant="outline" size="lg" class="check-icon" />
        </div>
        <h1 class="title">{{ 'auth.forgotPassword.emailSent.title' | translate }}</h1>
        <p class="subtitle">{{ 'auth.forgotPassword.emailSent.subtitle' | translate }}</p>
      }
    </div>

    <!-- Success Message -->
    @if (successMessage()) {
      <ui-success-alert [message]="successMessage()!"></ui-success-alert>
    }

    <!-- Error Message -->
    @if (errorMessage()) {
      <ui-error-alert [message]="errorMessage()!"></ui-error-alert>
    }

    <!-- Form -->
    @if (!emailSent()) {
      <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()" class="form">
        <ocr-input
          [label]="'common.labels.email' | translate"
          type="email"
          formControlName="email"
          [placeholder]="'common.placeholders.email' | translate"
          autocomplete="email"
          leadingIcon="mail"
          [required]="true"
          [error]="emailError"
        />

        <button type="submit" class="submit-button" [disabled]="isLoading()">
          @if (isLoading()) {
            <svg class="spinner" viewBox="0 0 24 24">
              <circle
                class="spinner-circle"
                cx="12"
                cy="12"
                r="10"
                stroke="currentColor"
                stroke-width="4"
                fill="none"
              ></circle>
            </svg>
            <span>{{ 'auth.forgotPassword.submitting' | translate }}</span>
          } @else {
            <span>{{ 'auth.forgotPassword.submit' | translate }}</span>
          }
        </button>
      </form>
    }

    <!-- Additional Info -->
    @if (emailSent()) {
      <div class="info-box">
        <p class="info-title">{{ 'auth.forgotPassword.nextSteps.title' | translate }}</p>
        <ol class="info-list">
          <li>{{ 'auth.forgotPassword.nextSteps.step1' | translate }}</li>
          <li>{{ 'auth.forgotPassword.nextSteps.step2' | translate }}</li>
          <li>{{ 'auth.forgotPassword.nextSteps.step3' | translate }}</li>
          <li>{{ 'auth.forgotPassword.nextSteps.step4' | translate }}</li>
        </ol>
        <p class="info-note">{{ 'auth.forgotPassword.nextSteps.linkValidity' | translate }}</p>
      </div>

      <button
        type="button"
        class="resend-button"
        [disabled]="isLoading()"
        (click)="emailSent.set(false)"
      >
        {{ 'auth.forgotPassword.resend' | translate }}
      </button>
    }

    <!-- Back to Login -->
    <div class="back-to-login">
      <a routerLink="/login" class="back-link">
        <lib-icon name="arrow-left" variant="outline" size="sm" class="arrow-icon" />
        <span>{{ 'auth.forgotPassword.backToLogin' | translate }}</span>
      </a>
    </div>
  </div>
</div>
