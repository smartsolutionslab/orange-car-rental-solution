<div class="hero">
  <h1>Finden Sie Ihr perfektes Fahrzeug</h1>
  <p class="subtitle">Günstige Mietwagen in ganz Deutschland</p>
</div>

<!-- Reusable Vehicle Search Component -->
<app-vehicle-search (searchSubmit)="onSearch($event)" />

<!-- Loading State -->
@if (loading()) {
  <ui-loading-state message="Lade Fahrzeuge..."></ui-loading-state>
}

<!-- Error State -->
@if (error()) {
  <ui-error-state [message]="error()!" [showRetry]="true" (retry)="onSearch(currentSearchQuery())"></ui-error-state>
}

<!-- Results Count -->
@if (!loading() && !error() && totalCount() > 0) {
  <div class="results-count">
    <svg class="results-icon" viewBox="0 0 24 24" fill="currentColor">
      <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.22.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/>
    </svg>
    <span><strong>{{ totalCount() }}</strong> Fahrzeug{{ totalCount() === 1 ? '' : 'e' }} gefunden</span>
  </div>
}

<!-- Vehicles Grid -->
@if (!loading() && vehicles().length > 0) {
  <div class="vehicles-grid">
    @for (vehicle of vehicles(); track vehicle.id) {
      <div class="vehicle-card">
        <div class="vehicle-image">
          @if (vehicle.imageUrl) {
            <img [src]="vehicle.imageUrl" [alt]="vehicle.name" />
          } @else {
            <div class="placeholder-image">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.92 6.01C18.72 5.42 18.16 5 17.5 5h-11c-.66 0-1.22.42-1.42 1.01L3 12v8c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h12v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-8l-2.08-5.99zM6.5 16c-.83 0-1.5-.67-1.5-1.5S5.67 13 6.5 13s1.5.67 1.5 1.5S7.33 16 6.5 16zm11 0c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM5 11l1.5-4.5h11L19 11H5z"/>
              </svg>
            </div>
          }
        </div>
        <div class="vehicle-details">
          <h3>{{ vehicle.name }}</h3>
          <div class="vehicle-info">
            <span class="category">{{ vehicle.categoryName }}</span>
            <span class="location">{{ vehicle.city }}</span>
          </div>
          <div class="vehicle-specs">
            <span class="spec">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M4 9h3V6H4c-1.1 0-2 .9-2 2v3h2V9zm0 4H2v3c0 1.1.9 2 2 2h3v-2H4v-3zm16-7v2h3V6c0-1.1-.9-2-2-2h-3v3h2zm-3 0h3v2h-3zM8 6h3v3H8zm3 11v2H8v-2h3zm-3-3h3v3H8zm8 3h3v2h-3zm3-11h-3v3h3zm-3 7h3v3h-3z"/>
              </svg>
              {{ vehicle.seats }} Sitze
            </span>
            <span class="spec">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M7 6h10v2H7zm0 4h10v2H7zm0 4h10v2H7z"/>
              </svg>
              {{ vehicle.transmissionType }}
            </span>
            <span class="spec">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M19.77 7.23l.01-.01-3.72-3.72L15 4.56l2.11 2.11c-.94.36-1.61 1.26-1.61 2.33 0 1.38 1.12 2.5 2.5 2.5.36 0 .69-.08 1-.21v7.21c0 .55-.45 1-1 1s-1-.45-1-1V14c0-1.1-.9-2-2-2h-1V5c0-1.1-.9-2-2-2H6c-1.1 0-2 .9-2 2v16h10v-7.5h1.5v5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V9c0-.69-.28-1.32-.73-1.77zM12 13.5V19H6v-7h6v1.5zm0-3.5H6V5h6v5z"/>
              </svg>
              {{ vehicle.fuelType }}
            </span>
          </div>
          <div class="vehicle-pricing">
            <div class="price-main">
              <span class="price-amount">{{ vehicle.dailyRateGross | number:'1.2-2':'de-DE' }} €</span>
              <span class="price-period">pro Tag</span>
            </div>
            <div class="price-details">
              <span>inkl. 19% MwSt.</span>
            </div>
          </div>
          <button class="btn-book" (click)="onBookVehicle(vehicle)">Jetzt buchen</button>
        </div>
      </div>
    }
  </div>
}

<!-- No Results -->
@if (!loading() && vehicles().length === 0 && !error()) {
  <ui-empty-state
    icon="search"
    title="Keine Fahrzeuge gefunden"
    description="Bitte ändern Sie Ihre Suchkriterien und versuchen Sie es erneut."
  ></ui-empty-state>
}
