<div class="hero">
  <h1>{{ 'vehicles.title' | translate }}</h1>
  <p class="subtitle">{{ 'vehicles.subtitle' | translate }}</p>
</div>

<!-- Reusable Vehicle Search Component -->
<app-vehicle-search (searchSubmit)="onSearch($event)" />

<!-- Loading State -->
@if (loading()) {
  <ui-loading-state [message]="'common.messages.loading' | translate"></ui-loading-state>
}

<!-- Error State -->
@if (error()) {
  <ui-error-state
    [message]="error()!"
    [showRetry]="true"
    (retry)="onSearch(currentSearchQuery())"
  ></ui-error-state>
}

<!-- Results Count -->
@if (!loading() && !error() && totalCount() > 0) {
  <div class="results-count">
    <lib-icon name="car-filled" variant="filled" size="sm" />
    <span>
      @if (totalCount() === 1) {
        {{ 'vehicles.results.found' | translate:{ count: totalCount() } }}
      } @else {
        {{ 'vehicles.results.foundPlural' | translate:{ count: totalCount() } }}
      }
    </span>
  </div>
}

<!-- Vehicles Grid -->
@if (!loading() && vehicles().length > 0) {
  <div class="vehicles-grid">
    @for (vehicle of vehicles(); track vehicle.id) {
      <div class="vehicle-card">
        <div class="vehicle-image">
          @if (vehicle.imageUrl) {
            <img [src]="vehicle.imageUrl" [alt]="vehicle.name" />
          } @else {
            <div class="placeholder-image">
              <lib-icon name="car-filled" variant="filled" size="sm" />
            </div>
          }
        </div>
        <div class="vehicle-details">
          <h3>{{ vehicle.name }}</h3>
          <div class="vehicle-info">
            <span class="category">{{ vehicle.categoryName }}</span>
            <span class="location">{{ vehicle.city }}</span>
          </div>
          <div class="vehicle-specs">
            <span class="spec">
              <lib-icon name="seats" variant="filled" size="sm" />
              {{ 'vehicles.card.seats' | translate:{ count: vehicle.seats } }}
            </span>
            <span class="spec">
              <lib-icon name="transmission" variant="filled" size="sm" />
              {{ vehicle.transmissionType }}
            </span>
            <span class="spec">
              <lib-icon name="fuel" variant="filled" size="sm" />
              {{ vehicle.fuelType }}
            </span>
          </div>
          <div class="vehicle-pricing">
            <div class="price-main">
              <span class="price-amount"
                >{{ vehicle.dailyRateGross | number: '1.2-2' : 'de-DE' }} â‚¬</span
              >
              <span class="price-period">{{ 'vehicles.card.perDay' | translate }}</span>
            </div>
            <div class="price-details">
              <span>{{ 'vehicles.card.inclVat' | translate }}</span>
            </div>
          </div>
          <button class="btn-book" (click)="onBookVehicle(vehicle)">{{ 'common.actions.bookNow' | translate }}</button>
        </div>
      </div>
    }
  </div>
}

<!-- No Results -->
@if (!loading() && vehicles().length === 0 && !error()) {
  <ui-empty-state
    icon="search"
    [title]="'vehicles.results.noResults' | translate"
    [description]="'vehicles.results.noResultsHint' | translate"
  ></ui-empty-state>
}
